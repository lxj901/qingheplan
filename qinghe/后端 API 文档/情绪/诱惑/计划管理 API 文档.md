# ğŸŒ± é’ç¦¾è®¡åˆ’ - æƒ…ç»ªè®°å½•ã€è¯±æƒ‘è®°å½•ã€è®¡åˆ’ç®¡ç†APIæ–‡æ¡£
## iOSå‰ç«¯å¯¹æ¥ä¸“ç”¨ç‰ˆ

---

## ğŸ“‹ åŸºç¡€ä¿¡æ¯
- **APIåŸŸå**: `https://api.qinghejihua.com.cn`
- **åŸºç¡€è·¯å¾„**: `/api/v1`
- **è®¤è¯æ–¹å¼**: JWT Bearer Token
- **åè®®**: HTTPS
- **å†…å®¹ç±»å‹**: `application/json`

---

## ğŸ” è®¤è¯è¯´æ˜
é™¤äº†å¥åº·æ£€æŸ¥æ¥å£å¤–ï¼Œæ‰€æœ‰APIéƒ½éœ€è¦åœ¨è¯·æ±‚å¤´ä¸­åŒ…å«JWT tokenï¼š
```
Authorization: Bearer <your_jwt_token>
```

---

## ğŸ˜Š 1. æƒ…ç»ªè®°å½•API

### 1.1 åˆ›å»ºæƒ…ç»ªè®°å½•
**ç«¯ç‚¹**: `POST /api/v1/emotions`

#### è¯·æ±‚å‚æ•°
| å‚æ•° | ç±»å‹ | å¿…éœ€ | è¯´æ˜ | ç¤ºä¾‹ |
|------|------|------|------|------|
| `type` | String | âœ… | æƒ…ç»ªç±»å‹ | "å¼€å¿ƒ" |
| `intensity` | Int | âœ… | å¼ºåº¦ç­‰çº§ (1-10) | 8 |
| `trigger` | String | âŒ | è§¦å‘å› ç´  (æœ€å¤š200å­—ç¬¦) | "å·¥ä½œé¡ºåˆ©" |
| `note` | String | âŒ | å¤‡æ³¨è¯´æ˜ (æœ€å¤š300å­—ç¬¦) | "ä»Šå¤©å®Œæˆäº†é‡è¦é¡¹ç›®" |
| `tags` | [String] | âŒ | æ ‡ç­¾åˆ—è¡¨ | ["å·¥ä½œ", "æˆå°±æ„Ÿ"] |
| `weather` | String | âŒ | å¤©æ°”æƒ…å†µ (æœ€å¤š50å­—ç¬¦) | "æ™´å¤©" |
| `recordedAt` | String | âŒ | è®°å½•æ—¶é—´ (ISO 8601) | "2025-01-15T10:30:00Z" |

#### æƒ…ç»ªç±»å‹æšä¸¾å€¼
```
"å¼€å¿ƒ", "æ‚²ä¼¤", "éš¾è¿‡", "æ„¤æ€’", "ç„¦è™‘", "å¹³é™", 
"å…´å¥‹", "æ²®ä¸§", "ç´§å¼ ", "æ”¾æ¾", "æ»¡è¶³", "å›°æƒ‘", "å…¶ä»–"
```

#### è¯·æ±‚ç¤ºä¾‹
```json
{
  "type": "å¼€å¿ƒ",
  "intensity": 8,
  "trigger": "å®Œæˆäº†é‡è¦é¡¹ç›®",
  "note": "ä»Šå¤©å·¥ä½œå¾ˆé¡ºåˆ©ï¼Œå¿ƒæƒ…ç‰¹åˆ«å¥½",
  "tags": ["å·¥ä½œ", "æˆå°±æ„Ÿ"],
  "weather": "æ™´å¤©"
}
```

#### æˆåŠŸå“åº” (201)
```json
{
  "status": "success",
  "message": "æƒ…ç»ªè®°å½•åˆ›å»ºæˆåŠŸ",
  "data": {
    "emotion": {
      "id": 123,
      "userId": 1,
      "type": "å¼€å¿ƒ",
      "intensity": 8,
      "trigger": "å®Œæˆäº†é‡è¦é¡¹ç›®",
      "note": "ä»Šå¤©å·¥ä½œå¾ˆé¡ºåˆ©ï¼Œå¿ƒæƒ…ç‰¹åˆ«å¥½",
      "tags": ["å·¥ä½œ", "æˆå°±æ„Ÿ"],
      "weather": "æ™´å¤©",
      "recordedAt": "2025-01-15T10:30:00.000Z",
      "createdAt": "2025-01-15T10:30:00.000Z",
      "updatedAt": "2025-01-15T10:30:00.000Z"
    }
  }
}
```

### 1.2 è·å–æƒ…ç»ªè®°å½•åˆ—è¡¨
**ç«¯ç‚¹**: `GET /api/v1/emotions`

#### æŸ¥è¯¢å‚æ•°
| å‚æ•° | ç±»å‹ | å¿…éœ€ | è¯´æ˜ | ç¤ºä¾‹ |
|------|------|------|------|------|
| `page` | Int | âŒ | é¡µç  (é»˜è®¤1) | 1 |
| `limit` | Int | âŒ | æ¯é¡µæ•°é‡ (é»˜è®¤10) | 10 |
| `type` | String | âŒ | æƒ…ç»ªç±»å‹ç­›é€‰ | "å¼€å¿ƒ" |
| `minIntensity` | Int | âŒ | æœ€å°å¼ºåº¦ | 5 |
| `maxIntensity` | Int | âŒ | æœ€å¤§å¼ºåº¦ | 10 |
| `startDate` | String | âŒ | å¼€å§‹æ—¥æœŸ | "2025-01-01" |
| `endDate` | String | âŒ | ç»“æŸæ—¥æœŸ | "2025-01-31" |

#### æˆåŠŸå“åº” (200)
```json
{
  "status": "success",
  "data": {
    "emotions": [
      {
        "id": 123,
        "userId": 1,
        "type": "å¼€å¿ƒ",
        "intensity": 8,
        "trigger": "å®Œæˆäº†é‡è¦é¡¹ç›®",
        "note": "ä»Šå¤©å·¥ä½œå¾ˆé¡ºåˆ©ï¼Œå¿ƒæƒ…ç‰¹åˆ«å¥½",
        "tags": ["å·¥ä½œ", "æˆå°±æ„Ÿ"],
        "weather": "æ™´å¤©",
        "recordedAt": "2025-01-15T10:30:00.000Z",
        "createdAt": "2025-01-15T10:30:00.000Z",
        "updatedAt": "2025-01-15T10:30:00.000Z"
      }
    ],
    "pagination": {
      "currentPage": 1,
      "totalPages": 5,
      "totalEmotions": 50,
      "hasNextPage": true,
      "hasPrevPage": false
    }
  }
}
```

### 1.3 è·å–æƒ…ç»ªç»Ÿè®¡
**ç«¯ç‚¹**: `GET /api/v1/emotions/statistics`

#### æŸ¥è¯¢å‚æ•°
| å‚æ•° | ç±»å‹ | å¿…éœ€ | è¯´æ˜ | ç¤ºä¾‹ |
|------|------|------|------|------|
| `period` | Int | âŒ | ç»Ÿè®¡å¤©æ•° (é»˜è®¤30) | 30 |

#### æˆåŠŸå“åº” (200)
```json
{
  "status": "success",
  "data": {
    "totalRecords": 45,
    "averageIntensity": 6.8,
    "emotionDistribution": {
      "å¼€å¿ƒ": 15,
      "ç„¦è™‘": 8,
      "å¹³é™": 12,
      "å…¶ä»–": 10
    },
    "intensityDistribution": {
      "1-3": 5,
      "4-6": 20,
      "7-10": 20
    },
    "weeklyTrend": [
      {"week": "2025-W02", "averageIntensity": 7.2, "count": 12},
      {"week": "2025-W03", "averageIntensity": 6.5, "count": 15}
    ],
    "healthScore": 72
  }
}
```

### 1.4 è·å–å•ä¸ªæƒ…ç»ªè®°å½•
**ç«¯ç‚¹**: `GET /api/v1/emotions/{id}`

### 1.5 æ›´æ–°æƒ…ç»ªè®°å½•
**ç«¯ç‚¹**: `PUT /api/v1/emotions/{id}`

### 1.6 åˆ é™¤æƒ…ç»ªè®°å½•
**ç«¯ç‚¹**: `DELETE /api/v1/emotions/{id}`

---

## ğŸ¯ 2. è¯±æƒ‘è®°å½•API

### 2.1 åˆ›å»ºè¯±æƒ‘è®°å½•
**ç«¯ç‚¹**: `POST /api/v1/temptations`

#### è¯·æ±‚å‚æ•°
| å‚æ•° | ç±»å‹ | å¿…éœ€ | è¯´æ˜ | ç¤ºä¾‹ |
|------|------|------|------|------|
| `type` | String | âœ… | è¯±æƒ‘ç±»å‹ | "æ‹–å»¶ç—‡" |
| `intensity` | Int | âœ… | å¼ºåº¦ç­‰çº§ (1-10) | 6 |
| `result` | String | âœ… | æŠµæŠ—ç»“æœ | "å·²æŠµæŠ—ä½" |
| `note` | String | âŒ | å¤‡æ³¨è¯´æ˜ (æœ€å¤š300å­—ç¬¦) | "é€šè¿‡ä¸“æ³¨å·¥ä½œæˆåŠŸæŠµæŠ—" |
| `strategies` | [String] | âŒ | æŠµæŠ—ç­–ç•¥åˆ—è¡¨ | ["æ·±å‘¼å¸", "ä¸“æ³¨å·¥ä½œ"] |
| `recordTime` | String | âŒ | è®°å½•æ—¶é—´ (ISO 8601) | "2025-01-15T14:30:00Z" |

#### è¯±æƒ‘ç±»å‹æšä¸¾å€¼
```
"æŠ½çƒŸ", "å–é…’", "ç†¬å¤œ", "æš´é¥®æš´é£Ÿ", "è´­ç‰©å†²åŠ¨", 
"æ¸¸æˆæ²‰è¿·", "åˆ·æ‰‹æœº", "æ‹–å»¶ç—‡", "åƒé›¶é£Ÿ", "å…¶ä»–"
```

#### æŠµæŠ—ç»“æœæšä¸¾å€¼
```
"å·²æŠµæŠ—ä½", "æœªæŠµæŠ—ä½"
```

#### è¯·æ±‚ç¤ºä¾‹
```json
{
  "type": "æ‹–å»¶ç—‡",
  "intensity": 6,
  "result": "å·²æŠµæŠ—ä½",
  "note": "é€šè¿‡ä¸“æ³¨å·¥ä½œæˆåŠŸæŠµæŠ—äº†æ‹–å»¶çš„è¯±æƒ‘",
  "strategies": ["ä¸“æ³¨å·¥ä½œ", "è®¾å®šç›®æ ‡"]
}
```

#### æˆåŠŸå“åº” (201)
```json
{
  "status": "success",
  "message": "è¯±æƒ‘è®°å½•åˆ›å»ºæˆåŠŸ",
  "data": {
    "temptation": {
      "id": 456,
      "userId": 1,
      "type": "æ‹–å»¶ç—‡",
      "intensity": 6,
      "resisted": true,
      "strategy": "ä¸“æ³¨å·¥ä½œ, è®¾å®šç›®æ ‡",
      "note": "é€šè¿‡ä¸“æ³¨å·¥ä½œæˆåŠŸæŠµæŠ—äº†æ‹–å»¶çš„è¯±æƒ‘",
      "recordedAt": "2025-01-15T14:30:00.000Z",
      "createdAt": "2025-01-15T14:30:00.000Z",
      "updatedAt": "2025-01-15T14:30:00.000Z"
    }
  }
}
```

### 2.2 è·å–è¯±æƒ‘è®°å½•åˆ—è¡¨
**ç«¯ç‚¹**: `GET /api/v1/temptations`

#### æŸ¥è¯¢å‚æ•°
| å‚æ•° | ç±»å‹ | å¿…éœ€ | è¯´æ˜ | ç¤ºä¾‹ |
|------|------|------|------|------|
| `page` | Int | âŒ | é¡µç  (é»˜è®¤1) | 1 |
| `limit` | Int | âŒ | æ¯é¡µæ•°é‡ (é»˜è®¤10) | 10 |
| `type` | String | âŒ | è¯±æƒ‘ç±»å‹ç­›é€‰ | "æ‹–å»¶ç—‡" |
| `result` | String | âŒ | æŠµæŠ—ç»“æœç­›é€‰ | "å·²æŠµæŠ—ä½" |
| `minIntensity` | Int | âŒ | æœ€å°å¼ºåº¦ | 5 |
| `maxIntensity` | Int | âŒ | æœ€å¤§å¼ºåº¦ | 10 |
| `startDate` | String | âŒ | å¼€å§‹æ—¥æœŸ | "2025-01-01" |
| `endDate` | String | âŒ | ç»“æŸæ—¥æœŸ | "2025-01-31" |

### 2.3 è·å–è¯±æƒ‘ç»Ÿè®¡
**ç«¯ç‚¹**: `GET /api/v1/temptations/statistics`

#### æŸ¥è¯¢å‚æ•°
| å‚æ•° | ç±»å‹ | å¿…éœ€ | è¯´æ˜ | ç¤ºä¾‹ |
|------|------|------|------|------|
| `period` | Int | âŒ | ç»Ÿè®¡å¤©æ•° (é»˜è®¤30) | 30 |

#### æˆåŠŸå“åº” (200)
```json
{
  "status": "success",
  "data": {
    "totalRecords": 32,
    "resistanceRate": 75.0,
    "averageIntensity": 5.8,
    "temptationDistribution": {
      "æ‹–å»¶ç—‡": 12,
      "åˆ·æ‰‹æœº": 8,
      "åƒé›¶é£Ÿ": 6,
      "å…¶ä»–": 6
    },
    "resistanceByType": {
      "æ‹–å»¶ç—‡": {"total": 12, "resisted": 9, "rate": 75.0},
      "åˆ·æ‰‹æœº": {"total": 8, "resisted": 6, "rate": 75.0}
    },
    "weeklyTrend": [
      {"week": "2025-W02", "resistanceRate": 80.0, "count": 10},
      {"week": "2025-W03", "resistanceRate": 70.0, "count": 12}
    ],
    "improvementScore": 78
  }
}
```

---

## ğŸ“‹ 3. è®¡åˆ’ç®¡ç†API

### 3.1 åˆ›å»ºè®¡åˆ’
**ç«¯ç‚¹**: `POST /api/v1/plans`

#### è¯·æ±‚å‚æ•°
| å‚æ•° | ç±»å‹ | å¿…éœ€ | è¯´æ˜ | ç¤ºä¾‹ |
|------|------|------|------|------|
| `title` | String | âœ… | è®¡åˆ’æ ‡é¢˜ (1-100å­—ç¬¦) | "æ¯æ—¥æ™¨è·‘è®¡åˆ’" |
| `description` | String | âŒ | è®¡åˆ’æè¿° (æœ€å¤š500å­—ç¬¦) | "æ¯å¤©æ—©ä¸Š6ç‚¹å¼€å§‹æ™¨è·‘30åˆ†é’Ÿ" |
| `category` | String | âŒ | è®¡åˆ’åˆ†ç±» | "å¥åº·" |
| `priority` | String | âŒ | ä¼˜å…ˆçº§ | "é«˜" |
| `targetType` | String | âŒ | ç›®æ ‡ç±»å‹ | "habit" |
| `startTime` | String | âŒ | å¼€å§‹æ—¶é—´ (ISO 8601) | "2025-01-16T06:00:00Z" |
| `endTime` | String | âŒ | ç»“æŸæ—¶é—´ (ISO 8601) | "2025-03-16T06:30:00Z" |
| `startDate` | String | âŒ | å¼€å§‹æ—¥æœŸ (YYYY-MM-DD) | "2025-01-16" |
| `endDate` | String | âŒ | ç»“æŸæ—¥æœŸ (YYYY-MM-DD) | "2025-03-16" |

#### è®¡åˆ’åˆ†ç±»æšä¸¾å€¼
```
"å·¥ä½œ", "å­¦ä¹ ", "ç”Ÿæ´»", "å¥åº·", "å¨±ä¹", "é€šç”¨"
```

#### ä¼˜å…ˆçº§æšä¸¾å€¼
```
"é«˜", "ä¸­", "ä½"
```

#### ç›®æ ‡ç±»å‹æšä¸¾å€¼
```
"habit" (ä¹ æƒ¯), "goal" (ç›®æ ‡), "challenge" (æŒ‘æˆ˜)
```

#### è¯·æ±‚ç¤ºä¾‹
```json
{
  "title": "æ¯æ—¥æ™¨è·‘è®¡åˆ’",
  "description": "æ¯å¤©æ—©ä¸Š6ç‚¹å¼€å§‹æ™¨è·‘30åˆ†é’Ÿï¼Œæé«˜èº«ä½“ç´ è´¨",
  "category": "å¥åº·",
  "priority": "é«˜",
  "targetType": "habit",
  "startDate": "2025-01-16",
  "endDate": "2025-03-16"
}
```

#### æˆåŠŸå“åº” (201)
```json
{
  "status": "success",
  "message": "è®¡åˆ’åˆ›å»ºæˆåŠŸ",
  "data": {
    "plan": {
      "id": 789,
      "userId": 1,
      "title": "æ¯æ—¥æ™¨è·‘è®¡åˆ’",
      "description": "æ¯å¤©æ—©ä¸Š6ç‚¹å¼€å§‹æ™¨è·‘30åˆ†é’Ÿï¼Œæé«˜èº«ä½“ç´ è´¨",
      "category": "å¥åº·",
      "priority": "é«˜",
      "status": "å¾…å¼€å§‹",
      "progress": 0,
      "startTime": "2025-01-16T06:00:00.000Z",
      "endTime": "2025-03-16T06:30:00.000Z",
      "completedAt": null,
      "createdAt": "2025-01-15T15:00:00.000Z",
      "updatedAt": "2025-01-15T15:00:00.000Z"
    }
  }
}
```
