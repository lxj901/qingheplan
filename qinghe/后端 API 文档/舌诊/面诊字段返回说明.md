# 舌诊面诊专业版v2 - 完整返回字段说明

## 📋 API响应格式概览

修复后的舌诊面诊API现在完全符合专业版v2标准，返回以下完整结构：

## 🎯 舌诊API返回示例

```json
{
  "code": 0,                    // 状态码（0=成功）
  "success": true,              // 是否成功
  "msg": "成功",                // 返回信息
  "data": {
    // ===== 基础评估信息 =====
    "score": 65,                          // 健康评分（0-100）
    "physique_name": "气虚体质",          // 体质名称
    "physique_analysis": "气虚者常见疲乏、少气懒言，易出汗，动则尤甚。",  // 体质说明
    "typical_symptom": "容易疲劳，面色萎黄，舌质淡，语声低弱",         // 典型症候
    "risk_warning": "存在轻度气虚风险，请注意休息与营养",            // 风险提示
    
    // ===== 中医辨证信息 =====
    "syndrome_name": "气虚血瘀",                                    // 中医证候
    "syndrome_introduction": "气虚推动无力，血行不畅，易致瘀阻。",    // 证候介绍
    
    // ===== 舌象检测坐标（重要！） =====
    "tf_detect_matches": {               // 舌象检测坐标
      "x": 10,                          // X坐标
      "y": 20,                          // Y坐标  
      "w": 50,                          // 宽度
      "h": 30                           // 高度
    },
    
    // ===== 特征详细分析 =====
    "features": [                        // 舌/面诊特征集合
      {
        "name": "淡红",                  // 特征名称
        "value": "正常",                 // 检测值
        "desc": "舌色淡红，多属正常或轻度气虚",  // 说明
        "status": "正常"                 // 正常/异常
      },
      {
        "name": "白苔",
        "value": "正常", 
        "desc": "苔色白，多见于平和或气虚体质",
        "status": "正常"
      },
      {
        "name": "薄",
        "value": "正常",
        "desc": "苔薄，邪浅或正气尚可", 
        "status": "正常"
      },
      {
        "name": "偏黄",
        "value": "异常",
        "desc": "面色萎黄，多见于气血不足",
        "status": "异常"
      }
    ],
    
    // ===== 多体质分布 =====
    "physique_distribution": [           // 体质分布详情
      {
        "name": "气虚质",               // 体质名称
        "score": 60                     // 分数
      },
      {
        "name": "湿热质",
        "score": 15
      },
      {
        "name": "血瘀质", 
        "score": 10
      },
      {
        "name": "平和质",
        "score": 15
      }
    ],
    
    // ===== 舌象细分详情 =====
    "tongueDetails": {                   // 舌象细分
      "bodyColor": "正常",              // 舌体颜色
      "coatingColor": "正常",           // 舌苔颜色
      "coatingThickness": "正常",        // 舌苔厚薄
      "moisture": "",                   // 津液情况
      "teethMarks": "",                 // 齿痕
      "cracks": ""                      // 裂纹
    },
    
    // ===== 多维度调理建议 =====
    "advices": {
      "饮食建议": {                     // 饮食建议
        "推荐": [                       // 推荐食物
          "鸡肉", "鸽肉", "羊肉", "莲子", 
          "山药", "红枣", "枸杞"
        ],
        "禁忌": [                       // 禁忌食物
          "辛辣", "咖啡", "酒精", "冷饮"
        ]
      },
      "食疗方": [                       // 食疗方剂
        "黄芪炖鸡", 
        "红枣桂圆茶", 
        "山药莲子粥"
      ],
      "运动建议": [                     // 运动建议
        "太极", "八段锦", "轻瑜伽", "散步"
      ],
      "睡眠/起居": [                    // 睡眠起居
        "保持规律作息",
        "避免熬夜", 
        "保持环境温暖安静"
      ],
      "情志调节": [                     // 情志调节
        "冥想", "呼吸训练", "舒缓音乐放松"
      ],
      "音乐疗法": [                     // 五音疗法
        "徵音（适合气虚调理）"
      ],
      "中医调理": [                     // 中医调理
        "艾灸：关元、气海、足三里",
        "按摩：三阴交、太冲",
        "中药泡脚：艾叶、红花、当归",
        "可配合刮痧/拔罐（体质合适时）"
      ]
    },
    
    // ===== 商品推荐 =====
    "goods": [                          // 推荐产品
      "艾灸仪", "精油", "拔罐器", 
      "助眠灯", "健康茶饮"
    ],
    
    // ===== 元信息 =====
    "originalImageUrl": "https://qinghe-uploads.oss-cn-beijing.aliyuncs.com/1727584989572-tongue-test.jpg",
    "analyzedAt": "2025-09-27T06:51:17.616Z",
    "analysisStatus": "completed",
    "apiProvider": "aliyun"
  }
}
```

## 🎯 面诊API返回示例

面诊API返回类似结构，主要差异：

```json
{
  "code": 0,
  "success": true, 
  "msg": "成功",
  "data": {
    // 基础字段相同...
    "score": 70,
    "physique_name": "湿热体质",
    
    // 面诊特有字段
    "features": [                        // 面部特征
      {
        "name": "面色",
        "value": "红润", 
        "desc": "面色正常",
        "status": "正常"
      },
      {
        "name": "精神",
        "value": "良好",
        "desc": "精神状态佳", 
        "status": "正常"
      }
    ],
    
    // 面诊不返回tf_detect_matches
    // 其他字段结构相同...
  }
}
```

## 🎯 关键字段说明

### ✅ 必须字段（v2标准）
- `code`, `success`, `msg` - 基础响应
- `score` - 健康评分
- `physique_name` - 体质名称  
- `physique_analysis` - 体质分析
- `typical_symptom` - 典型症候
- `risk_warning` - 风险提示
- `syndrome_name` - 中医证候
- `syndrome_introduction` - 证候介绍
- `features[]` - 特征数组（name, value, desc, status）
- `physique_distribution[]` - 体质分布（name, score）
- `advices{}` - 7类建议分类
- `goods[]` - 商品推荐


### ⭐ 特有字段
- `tf_detect_matches` - **仅舌诊返回**，舌象定位坐标
- `tongueDetails` - **仅舌诊返回**，舌象细分

## 🔗 API端点

- **舌诊**: `POST /api/v1/health/tongue/analyze`
- **面诊**: `POST /api/v1/health/face/analyze`  
- **舌诊历史**: `GET /api/v1/health/tongue/history`
- **面诊历史**: `GET /api/v1/health/face/history`

## ✅ 修复成果

1. **完整v2格式**：所有字段符合专业版v2文档要求
2. **坐标信息**：正确返回`tf_detect_matches`舌象定位
3. **特征结构**：标准化`features`数组格式
4. **体质分布**：完整的`physique_distribution`
5. **建议分类**：7类完整的`advices`结构
6. **兼容性**：保持向下兼容，新增字段不影响现有功能