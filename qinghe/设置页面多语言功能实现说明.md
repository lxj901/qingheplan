# 设置页面多语言功能实现说明

## 概述

本次实现为青禾计划 iOS 应用的设置页面添加了完整的多语言支持，支持简体中文、繁体中文、英文、日文和韩文五种语言。

## 实现内容

### 1. 多语言管理器 (LocalizationManager)

创建了一个 `LocalizationManager` 类来管理应用的多语言状态：

- **功能**：
  - 管理当前选择的语言
  - 提供本地化字符串获取方法
  - 自动保存语言设置到 UserDefaults
  - 支持实时语言切换

- **使用方式**：
  ```swift
  @StateObject private var localizationManager = LocalizationManager()
  let localizedText = localizationManager.localizedString(key: "settings")
  ```

### 2. 本地化字符串系统 (LocalizedStrings)

实现了一个完整的本地化字符串系统：

- **支持的语言**：
  - 简体中文 (zh-Hans)
  - 繁体中文 (zh-Hant)
  - 英文 (en)
  - 日文 (ja)
  - 韩文 (ko)

- **包含的字符串**：
  - 设置页面所有菜单项
  - 用户状态文本
  - 系统提示信息
  - 按钮文本

### 3. 设置页面多语言化

更新了设置页面的所有文本显示：

#### 主要更新内容：
- **页面标题**：设置
- **菜单分组**：
  - 账户与安全
  - 个性化
  - 存储与权限
  - 关于与帮助
  - 规则与协议
  - 隐私信息

- **菜单项**：
  - 账号与安全
  - 隐私设置
  - 背景设置
  - 字体大小
  - 多语言
  - 清理缓存
  - 系统权限
  - 应用权限
  - 关于青禾计划
  - 了解广告推送
  - 反馈与帮助
  - 青禾规则中心
  - 资质证照
  - 用户协议
  - 个人信息收集清单
  - 第三方信息共享清单

- **用户状态文本**：
  - 加载中...
  - 正在获取用户信息
  - 未登录
  - 请先登录
  - 未绑定手机
  - 青禾用户

### 4. 多语言设置页面增强

增强了多语言设置页面：

- **实时语言切换**：选择语言后立即更新界面
- **本地化提示文本**：所有提示信息都支持多语言
- **重启提醒**：提供多语言的重启应用提醒

## 技术实现

### 1. 架构设计

```
LocalizationManager (多语言管理器)
    ↓
LocalizedStrings (本地化字符串)
    ↓
各语言字符串映射函数
    ↓
UI 组件调用
```

### 2. 核心代码结构

```swift
// 多语言管理器
class LocalizationManager: ObservableObject {
    @Published var currentLanguage: String
    func localizedString(key: String) -> String
    func setLanguage(_ language: String)
}

// 本地化字符串
struct LocalizedStrings {
    static func getString(key: String, language: String) -> String
    private static func getChineseSimplified(key: String) -> String
    private static func getChineseTraditional(key: String) -> String
    private static func getEnglish(key: String) -> String
    private static func getJapanese(key: String) -> String
    private static func getKorean(key: String) -> String
}
```

### 3. 使用示例

```swift
// 在视图中使用
struct SettingsView: View {
    @StateObject private var localizationManager = LocalizationManager()
    
    var body: some View {
        Text(localizationManager.localizedString(key: "settings"))
        Section(localizationManager.localizedString(key: "account_security")) {
            // 菜单项
        }
    }
}
```

## 功能特点

### 1. 实时切换
- 用户选择语言后，界面立即更新
- 无需重启应用即可看到效果
- 语言设置自动保存

### 2. 完整覆盖
- 设置页面所有文本都支持多语言
- 包括标题、菜单项、状态文本、提示信息
- 支持动态内容的本地化

### 3. 易于扩展
- 新增语言只需添加对应的字符串映射函数
- 新增文本只需在各语言函数中添加对应的 case
- 模块化设计，便于维护

### 4. 性能优化
- 字符串获取采用 switch 语句，性能高效
- 语言设置缓存在内存中，避免重复读取
- 按需加载，不会影响应用启动速度

## 测试验证

创建了 `LocalizationTestView` 测试页面，可以：
- 实时切换语言查看效果
- 验证所有字符串的本地化
- 测试语言设置的保存和恢复

## 使用说明

### 1. 切换语言
1. 进入设置页面
2. 点击"多语言"菜单项
3. 选择目标语言
4. 确认重启提醒（可选择立即重启或稍后重启）

### 2. 开发者使用
1. 在需要多语言的视图中添加 `@StateObject private var localizationManager = LocalizationManager()`
2. 使用 `localizationManager.localizedString(key: "your_key")` 获取本地化字符串
3. 在 `LocalizedStrings` 中添加新的字符串键值对

## 后续扩展

### 1. 新增语言
- 在 `LanguageOption` 枚举中添加新语言
- 在 `LocalizedStrings` 中添加对应的字符串映射函数
- 更新语言选择界面

### 2. 新增文本
- 在各语言的字符串映射函数中添加新的 case
- 确保所有支持的语言都包含对应的翻译

### 3. 优化建议
- 可以考虑使用 .strings 文件进行本地化
- 添加语言包动态下载功能
- 支持地区特定的本地化（如 en-US, en-GB）

## 总结

本次实现为青禾计划应用提供了完整的设置页面多语言支持，采用了模块化、可扩展的架构设计，支持实时语言切换，为用户提供了更好的国际化体验。
