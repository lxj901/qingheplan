# 快速修复：沙盒账号重复登录问题

## 🚀 5分钟快速解决方案

### 第一步：退出沙盒账号（1分钟）
```
设置 → App Store → 滚动到底部 → 沙盒账户 → 退出登录
```

### 第二步：重启设备（2分钟）
```
长按电源键 → 滑动关机 → 等待10秒 → 重新开机
```

### 第三步：重新登录（1分钟）
```
设置 → App Store → 沙盒账户 → 登录
输入测试账号和密码
确认看到"已登录"
```

### 第四步：测试（1分钟）
```
打开App → 点击购买 → 应该直接弹出购买确认（不再要求登录）
```

---

## ✅ 如果上述方法还是不行

### 方案 A：清除App缓存
```
1. 删除设备上的App
2. 重启设备
3. 重新从Xcode安装
4. 重新登录沙盒账号
5. 测试购买
```

### 方案 B：使用新的测试账号
```
1. 访问 https://appstoreconnect.apple.com/
2. 用户和访问 → 沙盒测试员
3. 创建新的测试账号
4. 在设备上用新账号登录
5. 测试购买
```

---

## ⚠️ 重要提示

### ❌ 错误做法
- 不要在"设置 → 你的名字（Apple ID）"处登录沙盒账号
- 不要在多个设备同时使用同一个沙盒账号
- 不要使用真实的Apple ID进行沙盒测试

### ✅ 正确做法
- 只在"设置 → App Store → 沙盒账户"登录测试账号
- 一个沙盒账号同时只在一个设备使用
- 为测试创建专用的沙盒账号

---

## 📱 如何确认已经解决

**成功标志：**
- 点击购买后，直接显示价格确认弹窗
- 只需 Face ID/Touch ID 确认，不需要输入密码
- 不会弹出"使用现有Apple ID"的登录框

**失败标志：**
- 点击购买后弹出登录框
- 要求输入Apple ID密码
- 即使输入密码，下次还是弹出

---

## 💡 代码已优化

我已经添加了购买锁机制，防止重复点击导致的问题：
- ✅ 防止用户快速多次点击购买按钮
- ✅ 避免同时发起多个购买请求
- ✅ 减少系统重复要求登录

---

## 📞 需要更多帮助？

查看完整文档：[沙盒账号重复登录问题解决方案.md](沙盒账号重复登录问题解决方案.md)


