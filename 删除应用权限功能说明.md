# 删除应用权限功能说明

## 修改概述

从青禾计划应用中完全移除了"应用权限"设置选项及相关功能。

## 删除内容

### 1. 设置页面 UI（MessagesView.swift）

#### 删除的设置选项
- 从"存储与权限"分组中移除了"应用权限"选项（第1436行）
- 原本显示为：`settingRow(icon: "checkmark.shield.fill", iconColor: .green, title: "应用权限")`

#### 删除的点击处理逻辑
- 移除了应用权限的本地化字符串变量（第1612行）
- 移除了点击处理的 case 分支（第1640-1642行）

#### 删除的本地化字符串
移除了所有语言的"app_permissions"本地化文本：
- **简体中文**：`case "app_permissions": return "应用权限"`
- **繁体中文**：`case "app_permissions": return "應用權限"`
- **英语**：`case "app_permissions": return "App Permissions"`
- **日语**：`case "app_permissions": return "アプリ権限"`
- **韩语**：`case "app_permissions": return "앱 권한"`

#### 删除的导航目标
从 `SettingsDestination` 枚举中移除：
```swift
case appPermissions  // 已删除
```

#### 删除的导航视图
移除了导航目标对应的视图（第1517-1520行）：
```swift
case .appPermissions:
    AppPermissionsView(navigationPath: $navigationPath)
        .navigationBarHidden(true)
        .asSubView()
```

### 2. 应用权限页面定义（SettingsPages.swift）

#### 完整删除的 AppPermissionsView
移除了整个 `AppPermissionsView` 结构体（约78行代码），包括：
- 数据收集设置（使用分析、崩溃报告、个性化广告的 Toggle 开关）
- 权限说明文本
- 自定义导航栏
- 所有相关的状态管理

### 3. 其他文件修改（MoreSettingsPages.swift）

#### 更新了广告信息页面的文本
- **原文本**：`"您可以在\"应用权限\"中关闭个性化广告，但仍会看到广告，只是与您的兴趣相关性较低。"`
- **新文本**：`"青禾计划会根据您的兴趣和使用习惯展示相关内容和广告。"`

## 修改后的设置页面结构

### 存储与权限分组
现在只包含以下两个选项：
1. **清理缓存** - 清理应用缓存数据
2. **系统权限** - 查看和管理系统级权限（相机、麦克风、相册、位置、通知）

## 影响范围

### 已删除的功能
- ❌ 使用分析开关
- ❌ 崩溃报告开关
- ❌ 个性化广告开关
- ❌ 应用权限说明页面

### 保留的功能
- ✅ 系统权限查看（相机、麦克风、相册、位置、通知）
- ✅ 清理缓存功能
- ✅ 其他所有设置选项

## 技术细节

### 修改的文件列表
1. `qinghe/ /qinghe/qinghe/MessagesView.swift`
   - 删除 UI 选项
   - 删除点击处理逻辑
   - 删除本地化字符串（5种语言）
   - 删除导航枚举值
   - 删除导航视图

2. `qinghe/ /qinghe/qinghe/SettingsPages.swift`
   - 删除整个 AppPermissionsView 结构体

3. `qinghe/ /qinghe/qinghe/MoreSettingsPages.swift`
   - 更新广告信息页面的描述文本

### 代码清理状态
- ✅ 无编译错误
- ✅ 无 linter 警告
- ✅ 所有引用已清理
- ✅ 导航逻辑完整

## 验证建议

1. **编译测试**：确保应用可以正常编译
2. **UI 测试**：进入设置页面，确认"应用权限"选项已移除
3. **导航测试**：确认其他设置选项的导航正常工作
4. **文本检查**：查看"了解广告推送"页面，确认文本已更新

## 注意事项

1. 如果应用之前有保存用户的应用权限设置（如 UserDefaults），这些数据不会被自动清理，但不会影响应用运行
2. 删除此功能后，应用将无法让用户控制数据收集和个性化广告设置
3. 如果需要恢复此功能，可以从 git 历史中找回相关代码

## 后续建议

如果未来需要数据收集控制功能，建议：
1. 在隐私设置中添加相关控制选项
2. 遵循平台隐私政策和法规要求
3. 提供清晰的隐私说明和用户同意机制


