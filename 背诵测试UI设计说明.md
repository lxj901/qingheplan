# 背诵测试 UI 设计说明

## 📋 设计概述

本次对背诵测试的**进行中页面**和**结果页面**进行了全面的 UI 重新设计，采用统一的古典国学风格，提升用户体验和视觉美感。

---

## 🎯 设计原则

### 1. 统一的视觉风格
- 两个页面采用相同的背景渐变和色彩方案
- 统一的卡片式布局和阴影效果
- 一致的字体层级和间距规范

### 2. 古典国学美学
- 米黄色渐变背景，模拟古籍纸张质感
- 青绿色主色调，代表沉稳与生机
- 竹简纹理装饰元素
- 优雅的圆角和留白

### 3. 信息层次清晰
- 重要信息使用大号字体和醒目颜色
- 辅助信息使用小号字体和浅色
- 卡片分组，内容结构化

---

## 📱 测试进行中页面设计

### 整体布局

```
┌─────────────────────────────┐
│   自定义导航栏（退出 + 标题）  │
├─────────────────────────────┤
│                             │
│   ┌───────────────────┐     │
│   │  第 X 题 / 共 N 题 │     │  ← 顶部信息卡片（简化）
│   └───────────────────┘     │
│                             │
│   ━━━━━━━━━━━━━━━━━━━     │  ← 进度条 + 进度点
│   已完成 X 题  还剩 X 题     │
│                             │
│   ┌───────────────────┐     │
│   │  📄 题目内容       │     │  ← 题目卡片
│   │                   │     │
│   │  [题目显示区域]    │     │
│   └───────────────────┘     │
│                             │
│   ┌───────────────────┐     │
│   │  ✏️ 答题区  (X字)  │     │  ← 答题卡片
│   │                   │     │
│   │  [输入框]         │     │
│   └───────────────────┘     │
│                             │
├─────────────────────────────┤
│  [上一题] [下一题] [提交答卷] │  ← 悬浮操作栏
└─────────────────────────────┘
```

### 主要改进

#### 1. 移除剩余时间显示
**原因**：根据用户反馈，剩余时间会给用户带来压力，影响答题体验。

**改进**：
- 顶部信息卡片只显示题目进度
- 采用"第 X 题 / 共 N 题"的表述方式
- 大号数字突出当前题号
- 卡片高度从 90pt 减少到 70pt，更加紧凑

#### 2. 优化题目进度显示
```swift
HStack(alignment: .firstTextBaseline, spacing: 4) {
    Text("第")
    Text("\(currentIndex + 1)")  // 36号加粗，青绿色
    Text("题")
    Text("/ 共 \(questions.count) 题")
}
```

#### 3. 进度条设计
- 渐变青绿色填充
- 每道题对应一个白色圆点
- 弹性动画效果
- 底部显示"已完成 X 题"和"还剩 X 题"

---

## 🏆 测试结果页面设计

### 整体布局

```
┌─────────────────────────────┐
│   自定义导航栏（返回 + 标题）  │
├─────────────────────────────┤
│                             │
│   ┌───────────────────┐     │
│   │                   │     │
│   │      ⭕ 85        │     │  ← 成绩卡片
│   │       分          │     │    (圆环进度 + 分数)
│   │                   │     │
│   │      优秀！        │     │
│   │   你对经典的理解... │     │
│   └───────────────────┘     │
│                             │
│   ┌───────────────────┐     │
│   │  ✓ 8  │ ✗ 2 │ 📄 10 │  │  ← 统计卡片
│   │  答对  │ 答错 │ 总题数│  │    (三栏布局)
│   └───────────────────┘     │
│                             │
│   ┌───────────────────┐     │
│   │ 📋 答题详情        │     │
│   │                   │     │
│   │  ① [题目1详情]    │     │  ← 答题详情
│   │  ② [题目2详情]    │     │    (每题一个卡片)
│   │  ...              │     │
│   └───────────────────┘     │
│                             │
└─────────────────────────────┘
```

### 核心设计元素

#### 1. 成绩卡片 - 圆环设计

**视觉效果**：
- 160x160 的圆环进度指示器
- 背景圆环：浅米色
- 进度圆环：
  - 及格（≥60分）：青绿色渐变
  - 不及格（<60分）：橙红色渐变
- 中心显示大号分数（56号字体）

**评价系统**：
- 90-100分：优秀！ + "你对经典的理解非常深刻，继续保持！"
- 80-89分：良好！ + "掌握得不错，再接再厉！"
- 60-79分：及格 + "基础尚可，多加练习会更好"
- <60分：需要加油 + "温故而知新，多读多背必有收获"

#### 2. 统计卡片 - 三栏布局

```
┌─────────┬─────────┬─────────┐
│    ✓    │    ✗    │    📄   │
│    8    │    2    │   10    │
│   答对   │  答错   │  总题数  │
└─────────┴─────────┴─────────┘
```

**特点**：
- 图标 + 数字 + 文字的垂直布局
- 竖线分隔，视觉清晰
- 答对：青绿色
- 答错：橙红色
- 总题数：深棕色

#### 3. 答题详情 - 卡片列表

每道题一个独立卡片，包含：

**题目标题行**：
- 圆形题号（正确：青绿色，错误：橙红色）
- 原文截断显示（最多15字）
- 对错图标（✓ 或 ✗）

**题干**（仅填空题）：
- 浅米色背景
- 显示遮挡后的题目文本

**你的答案**：
- 正确：青绿色文字 + 浅青绿色背景
- 错误：橙红色文字 + 浅橙红色背景
- 未作答：显示"(未作答)"

**正确答案**（仅错误时显示）：
- 青绿色文字
- 浅青绿色背景
- 帮助用户对比学习

---

## 🎨 色彩方案

### 主色调
- **青绿色**：`rgb(51, 140, 115)` - 主要操作、正确答案
- **橙红色**：`rgb(230, 102, 77)` - 错误答案、警告

### 背景色
- **渐变背景**：
  - 起点：`rgb(245, 242, 237)` - 浅米黄
  - 终点：`rgb(239, 235, 224)` - 深米黄
- **卡片背景**：`rgb(255, 255, 255)` - 纯白
- **输入框背景**：`rgb(250, 247, 242)` - 浅米色

### 文字色
- **主文字**：`rgb(51, 38, 26)` - 深棕色
- **次要文字**：`rgb(128, 115, 102)` - 中棕色
- **辅助文字**：`rgb(179, 166, 153)` - 浅棕色

---

## 📐 尺寸规范

### 圆角
- 大卡片：16pt - 20pt
- 小卡片：12pt
- 按钮：10pt - 12pt
- 输入框：8pt - 12pt

### 阴影
- 主卡片：`opacity: 0.08, radius: 8-12, y: 4-6`
- 按钮：`opacity: 0.3-0.4, radius: 4-8, y: 2-4`
- 导航栏：`opacity: 0.05, radius: 2, y: 2`

### 间距
- 卡片间距：20pt
- 内容内边距：16pt - 20pt
- 元素间距：8pt - 16pt

### 字体
- 超大标题：36pt - 56pt（分数、题号）
- 大标题：28pt（统计数字）
- 标题：17pt - 20pt（评价文字）
- 正文：14pt - 17pt（题目内容、答案）
- 小字：12pt - 13pt（标签、辅助信息）

---

## ✨ 交互细节

### 动画效果
1. **进度条动画**：
   - 使用 `.spring(response: 0.4, dampingFraction: 0.7)`
   - 切换题目时平滑过渡

2. **圆环动画**：
   - 结果页面加载时，圆环从 0 到实际进度
   - 可以添加 `.animation(.easeInOut(duration: 1.0))` 实现

3. **按钮反馈**：
   - 禁用状态：灰色 + 无阴影
   - 启用状态：彩色 + 阴影
   - 点击时：颜色变深

### 状态处理
1. **空数据处理**：
   - 题目为空时显示 EmptyView
   - 避免显示混乱的布局

2. **未作答处理**：
   - 显示"(未作答)"占位文字
   - 使用浅灰色表示

3. **长文本处理**：
   - 原文超过15字时截断 + "…"
   - 避免卡片高度不一致

---

## 🔧 技术实现要点

### 1. ZStack 分层布局
```swift
ZStack {
    LinearGradient(...)  // 背景层
    VStack {
        customNavigationBar
        ScrollView { ... }  // 内容层
    }
    VStack {
        Spacer()
        floatingActionBar  // 悬浮层（仅测试页）
    }
}
```

### 2. GeometryReader 动态计算
```swift
GeometryReader { geo in
    // 根据容器宽度计算进度条宽度
    .frame(width: progressWidth(in: geo.size.width))
}
```

### 3. 条件渲染
```swift
// 根据测试类型显示不同内容
if type == .fillBlank { ... }
else if type == .dictation || type == .listening { ... }
else { ... }

// 只在错误时显示正确答案
if !isCorrect { ... }
```

### 4. 数据规范化
```swift
private func normalize(_ s: String) -> String {
    let set = CharacterSet.whitespacesAndNewlines.union(.punctuationCharacters)
    return s.components(separatedBy: set).joined()
}
```
- 移除空白字符和标点符号
- 确保答案比对的准确性

---

## 📊 设计对比

| 方面 | 之前 | 现在 |
|------|------|------|
| **测试页 - 顶部** | 题目数 + 剩余时间 | 只显示题目进度 |
| **测试页 - 布局** | 简单堆叠 | 卡片式分层 |
| **结果页 - 成绩** | 简单文字 | 圆环进度 + 评价 |
| **结果页 - 统计** | 垂直列表 | 三栏横向布局 |
| **结果页 - 详情** | List 列表 | 独立卡片 |
| **整体风格** | 系统默认 | 古典国学 |
| **背景** | 纯白色 | 米黄渐变 |
| **导航栏** | 系统标准 | 自定义设计 |

---

## 🎉 总结

本次 UI 重新设计实现了以下目标：

✅ **统一风格**：测试页和结果页采用一致的视觉语言  
✅ **简化信息**：移除剩余时间，减少用户压力  
✅ **视觉升级**：圆环进度、卡片布局、渐变背景  
✅ **体验优化**：清晰的信息层次、友好的反馈提示  
✅ **国学美学**：古典色彩、优雅布局、文化氛围  

所有改动都在 `ReciteTestViews.swift` 文件中完成，没有修改数据模型和业务逻辑，确保了功能的稳定性。

